<html>
	<head>
	</head>
	<body>
		<canvas id='analyser' style="height: 100%;width: 100%">
		</canvas>
	</body>
	<script>
		var audio = new Audio();
		audio.src = 'https://darkheart527.github.io/darkheartprod/beats/Flames.mp3';
		audio.autoplay = true;
		audio.controls = true;
		var context, analyser, canvas, ctx, source;
		function init() {
			document.body.appendChild(audio);
			context = new AudioContext();
			analyser = context.createAnalyser();
			canvas = document.getElementById('analyser');
			ctx = canvas.getContext('2d');
			source = context.createMediaElementSource(audio);
			source.connect(analyser);
			analyser.connect(context.destination);
			frameLooper(context);
		}
		
		function frameLooper(context) {
			window.requestAnimationFrame(frameLooper);
			fbc_array = new Uint8Array(analyser.frequencyBinCount);
			analyser.getByteFrequencyData(fbc_array);
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.fillStyle = '#00CCFF';
			bars = 100;
			for (let i = 0; i < bars; i++) {
				bar_x = i * 3;
				bar_width = 2;
				bar_height = -(fbc_array[i] / 2);
				ctx.fillRect(bar_x, canvas.height, bar_width, bar_height);
			}
		}
		init();
	</script>
</html>